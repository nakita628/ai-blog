---
date: 2026-02-24
title: React 19 Hooks å®Ÿè·µã‚¬ã‚¤ãƒ‰ â€• ä½•ã‚’è§£æ±ºã—ã€ã©ã“ã§èº“ãã®ã‹
description: React 19 ã§è¿½åŠ ã•ã‚ŒãŸ useActionStateãƒ»useFormStatusãƒ»useOptimisticãƒ»use ã®4ã¤ã® Hook/API ã«ã¤ã„ã¦ã€ãã‚Œãã‚ŒãŒè§£æ±ºã™ã‚‹èª²é¡Œãƒ»æ­£ã—ã„ä½¿ã„æ–¹ãƒ»å…¸å‹çš„ãªã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã¨ã¨ã‚‚ã«è§£èª¬ã™ã‚‹ã€‚
tags:
  - react
  - typescript
  - hooks
  - javascript
prev:
  text: 'React 19 æ–°æ©Ÿèƒ½ã¨ Hooks å®Œå…¨ã‚¬ã‚¤ãƒ‰ â€• memoãƒ»useCallbackãƒ»useRef ã‹ã‚‰æ–° API ã¾ã§'
  link: '/posts/2026/02/23'
next: false
---

# React 19 Hooks å®Ÿè·µã‚¬ã‚¤ãƒ‰ â€• ä½•ã‚’è§£æ±ºã—ã€ã©ã“ã§èº“ãã®ã‹

React 19 ã§ã¯ `useActionState`ãƒ»`useFormStatus`ãƒ»`useOptimistic`ãƒ»`use` ã¨ã„ã†4ã¤ã® Hook/API ãŒæ–°ãŸã«è¿½åŠ ã•ã‚ŒãŸã€‚ã“ã‚Œã‚‰ã¯å¾“æ¥ `useState` + `useEffect` + æ‰‹å‹•ãƒ•ãƒ©ã‚°ç®¡ç†ã§å®Ÿè£…ã—ã¦ã„ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®£è¨€çš„ã«ç½®ãæ›ãˆã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚ã—ã‹ã—ã€å„ Hook ã«ã¯æ˜ç¢ºãªé©ç”¨ç¯„å›²ã¨ã€Œã‚„ã£ã¦ã¯ã„ã‘ãªã„ä½¿ã„æ–¹ã€ãŒå­˜åœ¨ã™ã‚‹ã€‚æœ¬è¨˜äº‹ã§ã¯ãã‚Œãã‚Œã® Hook ãŒ**ä½•ã‚’è§£æ±ºã—ã€ã©ã“ã§èº“ãã®ã‹**ã‚’å…·ä½“çš„ã«è§£èª¬ã™ã‚‹ã€‚

## å…¨ä½“åƒ â€• 4ã¤ã® Hook ã®ä½ç½®ã¥ã‘

```mermaid
flowchart TD
    Action[Actions / Transition] --> UAS[useActionState]
    Action --> UFS[useFormStatus]
    Action --> UO[useOptimistic]
    Suspense[Suspense] --> Use[use API]

    UAS -->|ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹ + pending| FormState[çŠ¶æ…‹ç®¡ç†ã®ä¸€å…ƒåŒ–]
    UFS -->|è¦ªãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡çŠ¶æ…‹| ParentForm[å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®çŠ¶æ…‹å‚ç…§]
    UO -->|å³åº§ã® UI åæ˜ | Optimistic[æ¥½è¦³çš„æ›´æ–°]
    Use -->|Promise / Context ã®èª­ã¿å–ã‚Š| DataFetch[ãƒ‡ãƒ¼ã‚¿å–å¾—ã®ç°¡ç´ åŒ–]

    style Action fill:#e67e22,color:#fff
    style Suspense fill:#3498db,color:#fff
    style FormState fill:#2ecc71,color:#fff
    style ParentForm fill:#2ecc71,color:#fff
    style Optimistic fill:#2ecc71,color:#fff
    style DataFetch fill:#2ecc71,color:#fff
```

| Hook             | ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ƒ | è§£æ±ºã™ã‚‹èª²é¡Œ                                  |
| ---------------- | ------------ | --------------------------------------------- |
| `useActionState` | `react`      | ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®çŠ¶æ…‹ãƒ»pendingãƒ»ã‚¨ãƒ©ãƒ¼ã®ä¸€å…ƒç®¡ç† |
| `useFormStatus`  | `react-dom`  | è¦ªãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡çŠ¶æ…‹ã‚’å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å‚ç…§  |
| `useOptimistic`  | `react`      | éåŒæœŸå‡¦ç†å®Œäº†å‰ã®å³åº§ãª UI åæ˜               |
| `use`            | `react`      | Promise / Context ã®å®£è¨€çš„ãªèª­ã¿å–ã‚Š          |

## useActionState â€• ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹ã®ä¸€å…ƒç®¡ç†

### ä½•ã‚’è§£æ±ºã™ã‚‹ã®ã‹

å¾“æ¥ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚’å®Ÿè£…ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«è¤‡æ•°ã® `useState` ãŒä¹±ç«‹ã—ã¦ã„ãŸã€‚

```tsx
// âŒ React 18 ä»¥å‰ã®å…¸å‹ãƒ‘ã‚¿ãƒ¼ãƒ³
function OldForm() {
  const [data, setData] = useState<Result | null>(null)
  const [error, setError] = useState<string | null>(null)
  const [isPending, setIsPending] = useState(false)

  async function handleSubmit(e: React.FormEvent) {
    e.preventDefault()
    setIsPending(true)
    setError(null)
    try {
      const result = await submitForm()
      setData(result)
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼')
    } finally {
      setIsPending(false)
    }
  }

  return <form onSubmit={handleSubmit}>...</form>
}
```

`useActionState` ã¯ã“ã®3ã¤ã®çŠ¶æ…‹ã‚’1ã¤ã® Hook ã«çµ±åˆã™ã‚‹ã€‚

```tsx
// âœ… React 19
import { useActionState } from 'react'

type FormState = {
  data: Result | null
  error: string | null
}

async function submitAction(prev: FormState, formData: FormData): Promise<FormState> {
  try {
    const result = await submitForm(formData)
    return { data: result, error: null }
  } catch (err) {
    return { data: null, error: err instanceof Error ? err.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼' }
  }
}

function NewForm() {
  const [state, formAction, isPending] = useActionState(submitAction, {
    data: null,
    error: null,
  })

  return (
    <form action={formAction}>
      <input name="name" />
      <button type="submit" disabled={isPending}>
        {isPending ? 'é€ä¿¡ä¸­...' : 'é€ä¿¡'}
      </button>
      {state.error && <p className="error">{state.error}</p>}
    </form>
  )
}
```

### ä½•ãŒã ã‚ãªã®ã‹ â€• ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

**1. Action å¤–ã‹ã‚‰ã®å‘¼ã³å‡ºã—**

`formAction` ã¯ `<form action>` ã¾ãŸã¯ `startTransition` å†…ã§å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚‹ã€‚é€šå¸¸ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰ç›´æ¥å‘¼ã¶ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚

```tsx
// âŒ ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
function handleClick() {
  formAction(new FormData())
}

// âœ… startTransition ã§å›²ã‚€
import { useTransition } from 'react'

function handleClick() {
  startTransition(() => {
    formAction(new FormData())
  })
}
```

**2. é€£ç¶šã‚¯ãƒªãƒƒã‚¯ã«ã‚ˆã‚‹ã‚­ãƒ¥ãƒ¼è©°ã¾ã‚Š**

`useActionState` ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’**é€æ¬¡å®Ÿè¡Œ**ã™ã‚‹ã€‚ãƒœã‚¿ãƒ³ã‚’4å›é€£æ‰“ã™ã‚‹ã¨ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Œäº†ã‚’å¾…ã¤ãŸã‚ã€åˆè¨ˆå¾…ã¡æ™‚é–“ãŒç©ã¿ä¸ŠãŒã‚‹ã€‚

```mermaid
sequenceDiagram
    participant User
    participant Action
    participant Server

    User->>Action: ã‚¯ãƒªãƒƒã‚¯1
    Action->>Server: ãƒªã‚¯ã‚¨ã‚¹ãƒˆ1
    User->>Action: ã‚¯ãƒªãƒƒã‚¯2ï¼ˆã‚­ãƒ¥ãƒ¼ã«å…¥ã‚‹ï¼‰
    User->>Action: ã‚¯ãƒªãƒƒã‚¯3ï¼ˆã‚­ãƒ¥ãƒ¼ã«å…¥ã‚‹ï¼‰
    Server-->>Action: ãƒ¬ã‚¹ãƒãƒ³ã‚¹1
    Action->>Server: ãƒªã‚¯ã‚¨ã‚¹ãƒˆ2
    Server-->>Action: ãƒ¬ã‚¹ãƒãƒ³ã‚¹2
    Action->>Server: ãƒªã‚¯ã‚¨ã‚¹ãƒˆ3
    Server-->>Action: ãƒ¬ã‚¹ãƒãƒ³ã‚¹3
```

å¯¾ç­–ã¨ã—ã¦ã€ãƒœã‚¿ãƒ³ã® `disabled` åˆ¶å¾¡ã§é€£æ‰“ã‚’é˜²ãã‹ã€`AbortController` ã§å‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã€‚

**3. ã‚¨ãƒ©ãƒ¼ throw ã§å¾Œç¶šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå…¨æ»…**

reducer é–¢æ•°å†…ã§ä¾‹å¤–ã‚’ throw ã™ã‚‹ã¨ã€ã‚­ãƒ¥ãƒ¼ã«å…¥ã£ã¦ã„ã‚‹å¾Œç¶šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã™ã¹ã¦ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚**å¿…ãš try-catch ã§å›²ã‚“ã§ã‚¨ãƒ©ãƒ¼ã‚’ state ã¨ã—ã¦è¿”ã™**ã“ã¨ã€‚

```tsx
// âŒ throw ã™ã‚‹ã¨ã‚­ãƒ¥ãƒ¼ãŒå£Šã‚Œã‚‹
async function badAction(prev: number) {
  const result = await fetchData()
  if (!result.ok) throw new Error('å¤±æ•—') // å¾Œç¶šã‚¢ã‚¯ã‚·ãƒ§ãƒ³å…¨æ»…
  return prev + 1
}

// âœ… ã‚¨ãƒ©ãƒ¼ã‚‚ state ã¨ã—ã¦è¿”ã™
async function goodAction(prev: FormState, formData: FormData): Promise<FormState> {
  try {
    const result = await fetchData(formData)
    return { success: true, error: null }
  } catch (err) {
    return { success: false, error: 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ' }
  }
}
```

## useFormStatus â€• å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹å‚ç…§

### ä½•ã‚’è§£æ±ºã™ã‚‹ã®ã‹

ãƒ•ã‚©ãƒ¼ãƒ å†…ã®ãƒœã‚¿ãƒ³ã‚„ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã§é€ä¿¡çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã€å¾“æ¥ã¯ props ã®ãƒã‚±ãƒ„ãƒªãƒ¬ãƒ¼ã‹ Context ãŒå¿…è¦ã ã£ãŸã€‚`useFormStatus` ã¯è¦ªã® `<form>` ã®é€ä¿¡çŠ¶æ…‹ã‚’**å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ç›´æ¥å‚ç…§**ã§ãã‚‹ã€‚

```tsx
import { useFormStatus } from 'react-dom'

function SubmitButton() {
  const { pending, data } = useFormStatus()

  return (
    <button type="submit" disabled={pending}>
      {pending ? 'é€ä¿¡ä¸­...' : 'é€ä¿¡'}
    </button>
  )
}

function ContactForm() {
  return (
    <form action={submitAction}>
      <input name="email" />
      <input name="message" />
      <SubmitButton />
    </form>
  )
}
```

### ä½•ãŒã ã‚ãªã®ã‹ â€• æœ€ã‚‚å¤šã„é–“é•ã„

**åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å‘¼ã¶ã¨å‹•ã‹ãªã„**ã€‚ã“ã‚Œã¯æœ€ã‚‚ã‚ˆãã‚ã‚‹ãƒŸã‚¹ã§ã‚ã‚‹ã€‚

```tsx
// âŒ pending ã¯å¸¸ã« false ã«ãªã‚‹
function BrokenForm() {
  const { pending } = useFormStatus() // ã“ã“ã§ã¯è¦ªãƒ•ã‚©ãƒ¼ãƒ ãŒå­˜åœ¨ã—ãªã„
  return (
    <form action={submitAction}>
      <button disabled={pending}>é€ä¿¡</button>
    </form>
  )
}

// âœ… å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åˆ†é›¢ã™ã‚‹
function SubmitButton() {
  const { pending } = useFormStatus() // è¦ªã® <form> ã‚’æ¤œå‡ºã™ã‚‹
  return <button disabled={pending}>é€ä¿¡</button>
}

function WorkingForm() {
  return (
    <form action={submitAction}>
      <SubmitButton />
    </form>
  )
}
```

```mermaid
flowchart TD
    Form["&lt;form action={...}&gt;"] --> Input["&lt;input /&gt;"]
    Form --> SB[SubmitButton]
    SB --> Hook["useFormStatus()"]
    Hook -->|"âœ… è¦ªã® form ã‚’æ¤œå‡º"| Status["{ pending, data, method, action }"]

    BrokenHook["useFormStatus()"] -->|"âŒ form ãŒè¦ªã«ãªã„"| Always["pending ã¯å¸¸ã« false"]

    style Form fill:#4a90d9,color:#fff
    style Hook fill:#2ecc71,color:#fff
    style BrokenHook fill:#e74c3c,color:#fff
    style Always fill:#e74c3c,color:#fff
```

ã“ã®åˆ¶ç´„ãŒå­˜åœ¨ã™ã‚‹ç†ç”±ã¯ã€`useFormStatus` ãŒ DOM ãƒ„ãƒªãƒ¼ä¸Šã®**ç›´è¿‘ã®ç¥–å…ˆ `<form>`** ã‚’æ¢ã™ä»•çµ„ã¿ã ã‹ã‚‰ã§ã‚ã‚‹ã€‚åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã—ãŸ `<form>` ã¯ã€Œè‡ªåˆ†è‡ªèº«ã€ã§ã‚ã‚Šã€Œè¦ªã€ã§ã¯ãªã„ã€‚

## useOptimistic â€• å³åº§ãª UI åæ˜ 

### ä½•ã‚’è§£æ±ºã™ã‚‹ã®ã‹

ã€Œã„ã„ã­ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã€ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å¾…ã£ã¦ã‹ã‚‰ UI ã‚’æ›´æ–°ã™ã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯é…å»¶ã¨ã—ã¦æ„Ÿã˜ã‚‰ã‚Œã‚‹ã€‚`useOptimistic` ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­ã«**ä»®ã®å€¤ã‚’å³åº§ã«è¡¨ç¤º**ã—ã€å®Œäº†å¾Œã«å®Ÿéš›ã®å€¤ã«åæŸã•ã›ã‚‹ã€‚

```tsx
import { useOptimistic, useState, useTransition } from 'react'

function LikeButton({ initialLiked }: { initialLiked: boolean }) {
  const [isLiked, setIsLiked] = useState(initialLiked)
  const [optimisticLiked, setOptimisticLiked] = useOptimistic(isLiked)
  const [, startTransition] = useTransition()

  function handleClick() {
    startTransition(async () => {
      setOptimisticLiked(!optimisticLiked) // å³åº§ã«åæ˜ 
      const result = await toggleLike(!isLiked) // ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
      setIsLiked(result) // å®Ÿéš›ã®å€¤ã§åæŸ
    })
  }

  return <button onClick={handleClick}>{optimisticLiked ? 'â¤ï¸' : 'ğŸ¤'}</button>
}
```

å¤±æ•—æ™‚ã¯è‡ªå‹•çš„ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã•ã‚Œã‚‹ãŸã‚ã€æ‰‹å‹•ã§ã®ãƒªãƒãƒ¼ãƒˆå‡¦ç†ãŒä¸è¦ã«ãªã‚‹ã€‚

### ä½•ãŒã ã‚ãªã®ã‹ â€• å…¸å‹çš„ãªãƒŸã‚¹

**1. Transition ã®å¤–ã§å‘¼ã¶ã¨ä¸€ç¬ã ã‘è¡¨ç¤ºã•ã‚Œã¦æ¶ˆãˆã‚‹**

```tsx
// âŒ Transition å¤–ã§ã®å‘¼ã³å‡ºã—
function handleClick() {
  setOptimisticLiked(true) // ä¸€ç¬è¡¨ç¤ºã•ã‚Œã¦å³åº§ã«ãƒªãƒãƒ¼ãƒˆ
  await toggleLike(true)
}

// âœ… startTransition ã§å›²ã‚€
function handleClick() {
  startTransition(async () => {
    setOptimisticLiked(true)
    await toggleLike(true)
  })
}
```

**2. å˜ç´”ãªå€¤ã‚»ãƒƒãƒˆã§å¤ã„çŠ¶æ…‹ã‚’å‚ç…§ã™ã‚‹**

ãƒ™ãƒ¼ã‚¹ã® state ãŒå¤–éƒ¨ã‹ã‚‰æ›´æ–°ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã€ç›´æ¥å€¤ã‚’ã‚»ãƒƒãƒˆã™ã‚‹ã¨å¤ã„å€¤ã‚’å‚ç…§ã—ã¦ã—ã¾ã†ã€‚

```tsx
// âŒ ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚«ã‚¦ãƒ³ãƒˆã‚’å¤‰æ›´ã—ãŸå ´åˆã«ä¸æ•´åˆ
const [optimisticCount, setOptimisticCount] = useOptimistic(count)
setOptimisticCount(count + 1) // count ãŒå¤ã„å¯èƒ½æ€§

// âœ… reducer ã‚’ä½¿ã£ã¦ç›¸å¯¾çš„ã«æ›´æ–°
const [optimisticCount, adjustCount] = useOptimistic(
  count,
  (current, delta: number) => current + delta,
)
adjustCount(1) // å¸¸ã«æœ€æ–°ã® current ã«å¯¾ã—ã¦ +1
```

**3. æ¥½è¦³çš„æ›´æ–°ã‚’æ°¸ç¶šåŒ–ã—ã‚ˆã†ã¨ã™ã‚‹**

`useOptimistic` ã®å€¤ã¯ Transition å®Œäº†ã¨åŒæ™‚ã«æ¶ˆãˆã‚‹ã€‚æ°¸ç¶šåŒ–ã—ãŸã„å ´åˆã¯åˆ¥é€” `useState` ã§ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

## use â€• Promise ã¨ Context ã®å®£è¨€çš„ãªèª­ã¿å–ã‚Š

### ä½•ã‚’è§£æ±ºã™ã‚‹ã®ã‹

`use` ã¯2ã¤ã®èª²é¡Œã‚’è§£æ±ºã™ã‚‹ã€‚

**èª²é¡Œ1: ãƒ‡ãƒ¼ã‚¿å–å¾—ã® `useEffect` åœ°ç„ã‹ã‚‰ã®è§£æ”¾**

```tsx
// âŒ å¾“æ¥ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ - useEffect + useState ã®çµ„ã¿åˆã‚ã›
function OldComments({ postId }: { postId: string }) {
  const [comments, setComments] = useState<Comment[]>([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<Error | null>(null)

  useEffect(() => {
    let cancelled = false
    setLoading(true)
    fetchComments(postId)
      .then((data) => {
        if (!cancelled) setComments(data)
      })
      .catch((err) => {
        if (!cancelled) setError(err)
      })
      .finally(() => {
        if (!cancelled) setLoading(false)
      })
    return () => {
      cancelled = true
    }
  }, [postId])

  if (loading) return <p>èª­ã¿è¾¼ã¿ä¸­...</p>
  if (error) return <p>ã‚¨ãƒ©ãƒ¼: {error.message}</p>
  return (
    <ul>
      {comments.map((c) => (
        <li key={c.id}>{c.text}</li>
      ))}
    </ul>
  )
}

// âœ… React 19 - use + Suspense
import { use, Suspense } from 'react'

function Comments({ commentsPromise }: { commentsPromise: Promise<Comment[]> }) {
  const comments = use(commentsPromise)
  return (
    <ul>
      {comments.map((c) => (
        <li key={c.id}>{c.text}</li>
      ))}
    </ul>
  )
}

function Page({ postId }: { postId: string }) {
  const commentsPromise = fetchComments(postId)
  return (
    <Suspense fallback={<p>èª­ã¿è¾¼ã¿ä¸­...</p>}>
      <Comments commentsPromise={commentsPromise} />
    </Suspense>
  )
}
```

**èª²é¡Œ2: Context ã®æ¡ä»¶ä»˜ãå‚ç…§**

`useContext` ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§ã—ã‹å‘¼ã¹ãªã„ãŒã€`use` ã¯ `if` æ–‡ã‚„ãƒ«ãƒ¼ãƒ—å†…ã§å‘¼ã¹ã‚‹ã€‚

```tsx
// âŒ useContext ã¯æ¡ä»¶åˆ†å²ã§ä½¿ãˆãªã„
function Component({ show }: { show: boolean }) {
  // if (show) { const theme = useContext(ThemeContext) } // ãƒ«ãƒ¼ãƒ«é•å

  const theme = useContext(ThemeContext) // å¸¸ã«å‘¼ã¶å¿…è¦ãŒã‚ã‚‹
  if (!show) return null
  return <div className={theme}>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
}

// âœ… use ã¯æ¡ä»¶åˆ†å²å†…ã§å‘¼ã¹ã‚‹
function Component({ show }: { show: boolean }) {
  if (!show) return null
  const theme = use(ThemeContext) // æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³å¾Œã§ã‚‚ OK
  return <div className={theme}>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
}
```

### ä½•ãŒã ã‚ãªã®ã‹ â€• æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆ

**1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ Promise ã‚’ç”Ÿæˆã—ãªã„**

ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãŸã³ã«æ–°ã—ã„ Promise ãŒç”Ÿæˆã•ã‚Œã€æ¯å› Suspense ãŒç™ºç«ã™ã‚‹ã€‚

```tsx
// âŒ æ¯å›æ–°ã—ã„ Promise ãŒä½œã‚‰ã‚Œã‚‹
function BadComponent() {
  const data = use(fetch('/api/data').then((r) => r.json()))
  return <div>{data.name}</div>
}

// âœ… è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¾ãŸã¯ Server Component ã§ Promise ã‚’ç”Ÿæˆ
function Parent() {
  const dataPromise = useMemo(() => fetchData(), [])
  return (
    <Suspense fallback={<p>èª­ã¿è¾¼ã¿ä¸­...</p>}>
      <Child dataPromise={dataPromise} />
    </Suspense>
  )
}

function Child({ dataPromise }: { dataPromise: Promise<Data> }) {
  const data = use(dataPromise)
  return <div>{data.name}</div>
}
```

**2. try-catch ã§å›²ã‚ãªã„**

`use` ã¯ Suspense ã®ä»•çµ„ã¿ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã€try-catch ã§ã¯ä¾‹å¤–ã‚’æ•æ‰ã§ããªã„ã€‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ Error Boundary ã‹ `Promise.catch` ã§è¡Œã†ã€‚

```tsx
// âŒ try-catch ã¯ä½¿ãˆãªã„
function Bad({ promise }: { promise: Promise<string> }) {
  try {
    const value = use(promise) // Suspense ä¾‹å¤–ãŒç™ºç”Ÿ
  } catch (e) {
    // ã“ã“ã«ã¯æ¥ãªã„
  }
}

// âœ… Error Boundary ã‚’ä½¿ã†
function Parent() {
  return (
    <ErrorBoundary fallback={<p>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</p>}>
      <Suspense fallback={<p>èª­ã¿è¾¼ã¿ä¸­...</p>}>
        <Child promise={dataPromise} />
      </Suspense>
    </ErrorBoundary>
  )
}

// âœ… ã¾ãŸã¯ Promise.catch ã§ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ã‚’è¿”ã™
const safePromise = fetchData().catch(() => ({ name: 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ' }))
```

## åˆ¤æ–­ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ â€• ã©ã® Hook ã‚’ä½¿ã†ã¹ãã‹

```mermaid
flowchart TD
    Start[å®Ÿè£…ã—ãŸã„ã“ã¨] --> Q1{ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®<br/>çŠ¶æ…‹ç®¡ç†?}
    Q1 -->|Yes| Q2{å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§<br/>çŠ¶æ…‹å‚ç…§ãŒå¿…è¦?}
    Q2 -->|Yes| UFS[useFormStatus]
    Q2 -->|No| UAS[useActionState]

    Q1 -->|No| Q3{ã‚µãƒ¼ãƒãƒ¼å¿œç­”å‰ã«<br/>UI ã‚’æ›´æ–°?}
    Q3 -->|Yes| UO[useOptimistic]
    Q3 -->|No| Q4{Promise / Context ã®<br/>èª­ã¿å–ã‚Š?}
    Q4 -->|Yes| UseAPI[use API]
    Q4 -->|No| Traditional[å¾“æ¥ã® Hooks<br/>useState / useReducer]

    style Start fill:#4a90d9,color:#fff
    style UAS fill:#2ecc71,color:#fff
    style UFS fill:#2ecc71,color:#fff
    style UO fill:#2ecc71,color:#fff
    style UseAPI fill:#2ecc71,color:#fff
    style Traditional fill:#95a5a6,color:#fff
```

## ã¾ã¨ã‚

| Hook             | è§£æ±ºã™ã‚‹èª²é¡Œ                               | ä¸»ãªè½ã¨ã—ç©´                                      |
| ---------------- | ------------------------------------------ | ------------------------------------------------- |
| `useActionState` | è¤‡æ•° `useState` ã®ä¸€å…ƒåŒ–ã€pending è‡ªå‹•ç®¡ç† | Transition å¤–ã§ã®å‘¼ã³å‡ºã—ã€throw ã«ã‚ˆã‚‹ã‚­ãƒ¥ãƒ¼ç ´å£Š |
| `useFormStatus`  | props ãƒã‚±ãƒ„ãƒªãƒ¬ãƒ¼ã®æ’é™¤                   | åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å‘¼ã¶ã¨å‹•ã‹ãªã„              |
| `useOptimistic`  | ãƒ¬ã‚¹ãƒãƒ³ã‚¹å¾…ã¡ã®ä½“æ„Ÿé…å»¶ã®è§£æ¶ˆ             | Transition å¤–ã§å‘¼ã¶ã¨å³ãƒªãƒãƒ¼ãƒˆã€å¤ã„çŠ¶æ…‹ã®å‚ç…§   |
| `use`            | useEffect ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç°¡ç´ åŒ–       | Client ã§ã® Promise å†ç”Ÿæˆã€try-catch ä¸å¯        |

React 19 ã®æ–°ã—ã„ Hook ã¯ã€Œã‚ˆãã‚ã‚‹å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚’å®£è¨€çš„ã«ç½®ãæ›ãˆã‚‹ã‚‚ã®ã ãŒã€ãã‚Œãã‚Œã«æ˜ç¢ºãªåˆ¶ç´„ãŒã‚ã‚‹ã€‚åˆ¶ç´„ã‚’ç†è§£ã›ãšã«ä½¿ã†ã¨ã€ã€Œpending ãŒå¸¸ã« falseã€ã€Œæ¥½è¦³çš„æ›´æ–°ãŒä¸€ç¬ã§æ¶ˆãˆã‚‹ã€ã€Œæ¯ãƒ¬ãƒ³ãƒ€ãƒ¼ã§ Suspense ãŒç™ºç«ã™ã‚‹ã€ã¨ã„ã£ãŸåˆ†ã‹ã‚Šã«ãã„ãƒã‚°ã«é­é‡ã™ã‚‹ã€‚å„ Hook ã®é©ç”¨ç¯„å›²ã‚’æ­£ã—ãæŠŠæ¡ã—ã€ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é¿ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã‚ã‚‹ã€‚

## å‚è€ƒ

- [React v19 å…¬å¼ãƒ–ãƒ­ã‚°](https://react.dev/blog/2024/12/05/react-19)
- [useActionState ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://react.dev/reference/react/useActionState)
- [useOptimistic ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://react.dev/reference/react/useOptimistic)
- [useFormStatus ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://react.dev/reference/react-dom/hooks/useFormStatus)
- [use API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://react.dev/reference/react/use)
- [React 19 New Hooks Explained with Examples - freeCodeCamp](https://www.freecodecamp.org/news/react-19-new-hooks-explained-with-examples/)
