---
date: 2025-09-21
title: Monaco Editor完全ガイド：VS Codeと同じエディタをWebアプリに組み込もう
description: Microsoft製のMonaco Editorの使い方を初心者向けに解説。基本的な導入から高度なカスタマイズまで、実際のコード例を交えて詳しく説明する。
tags:
  - monaco-editor
  - code-editor
  - web-development
  - javascript
  - typescript
  - microsoft
prev:
  text: '論理削除とは？物理削除との違いと実装方法を初心者向けに解説'
  link: '/posts/2025/09/20'
next: false
---

# Monaco Editor完全ガイド：VS Codeと同じエディタをWebアプリに組み込もう

[Monaco Editor](https://microsoft.github.io/monaco-editor/)は、Microsoftが開発したWebベースのコードエディタです。Visual Studio Codeと同じエディタエンジンを使用しており、シンタックスハイライト、自動補完、エラー検出などの高度な機能を提供します。

## Monaco Editorとは

Monaco Editorは、Visual Studio Codeで使用されているエディタエンジンをWebブラウザで使用できるようにしたものです。以下の特徴があります：

- **豊富な言語サポート**: JavaScript、TypeScript、Python、Java、C#など多数の言語に対応
- **高度な機能**: シンタックスハイライト、自動補完、エラー検出、フォーマット
- **カスタマイズ性**: テーマ、キーバインド、機能の有効/無効を自由に設定
- **軽量**: 必要な機能のみをバンドルしてサイズを最適化

## 基本的な導入方法

### CDNを使用した簡単な導入

```html
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monaco Editor サンプル</title>
    <style>
      #container {
        width: 100%;
        height: 500px;
        border: 1px solid #ccc;
      }
    </style>
  </head>
  <body>
    <h1>Monaco Editor デモ</h1>
    <div id="container"></div>

    <!-- Monaco Editorの読み込み -->
    <script src="https://unpkg.com/monaco-editor@0.44.0/min/vs/loader.js"></script>
    <script>
      require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.44.0/min/vs' } })

      require(['vs/editor/editor.main'], function () {
        // エディタの作成
        const editor = monaco.editor.create(document.getElementById('container'), {
          value: '// Hello, Monaco Editor!\nconsole.log("Hello, World!");',
          language: 'javascript',
          theme: 'vs-dark',
          automaticLayout: true,
        })
      })
    </script>
  </body>
</html>
```

### npmを使用した導入

```bash
npm install monaco-editor
```

```javascript
import * as monaco from 'monaco-editor'

// エディタの作成
const editor = monaco.editor.create(document.getElementById('container'), {
  value: '// TypeScript コード\ninterface User {\n  name: string;\n  age: number;\n}',
  language: 'typescript',
  theme: 'vs-dark',
})
```

## 基本的な設定とカスタマイズ

### エディタの基本設定

```javascript
const editor = monaco.editor.create(document.getElementById('container'), {
  // 初期値
  value: 'console.log("Hello, Monaco Editor!");',

  // 言語
  language: 'javascript',

  // テーマ
  theme: 'vs-dark', // 'vs', 'vs-dark', 'hc-black'

  // 自動レイアウト
  automaticLayout: true,

  // 行番号の表示
  lineNumbers: 'on',

  // 折り返し
  wordWrap: 'on',

  // ミニマップ
  minimap: { enabled: true },

  // 自動保存
  saveViewState: true,

  // フォント設定
  fontFamily: 'Consolas, "Courier New", monospace',
  fontSize: 14,

  // タブサイズ
  tabSize: 2,
  insertSpaces: true,

  // 選択範囲の強調
  selectOnLineNumbers: true,

  // カーソル設定
  cursorStyle: 'line',
  cursorBlinking: 'blink',
})
```

### テーマのカスタマイズ

```javascript
// カスタムテーマの定義
monaco.editor.defineTheme('myCustomTheme', {
  base: 'vs-dark',
  inherit: true,
  rules: [
    { token: 'comment', foreground: '6A9955', fontStyle: 'italic' },
    { token: 'keyword', foreground: '569CD6' },
    { token: 'string', foreground: 'CE9178' },
    { token: 'number', foreground: 'B5CEA8' },
  ],
  colors: {
    'editor.background': '#1e1e1e',
    'editor.foreground': '#d4d4d4',
    'editorLineNumber.foreground': '#858585',
    'editor.selectionBackground': '#264f78',
  },
})

// テーマの適用
monaco.editor.setTheme('myCustomTheme')
```

## 言語サポートの設定

### TypeScriptの設定

```javascript
// TypeScriptの設定
monaco.languages.typescript.typescriptDefaults.setCompilerOptions({
  target: monaco.languages.typescript.ScriptTarget.ES2020,
  allowNonTsExtensions: true,
  moduleResolution: monaco.languages.typescript.ModuleResolutionKind.NodeJs,
  module: monaco.languages.typescript.ModuleKind.CommonJS,
  noEmit: true,
  esModuleInterop: true,
  jsx: monaco.languages.typescript.JsxEmit.React,
  reactNamespace: 'React',
  allowJs: true,
  typeRoots: ['node_modules/@types'],
})

// 型定義の追加
monaco.languages.typescript.typescriptDefaults.addExtraLib(
  `
interface User {
    id: number;
    name: string;
    email: string;
}

declare const api: {
    getUser(id: number): Promise<User>;
    createUser(user: Omit<User, 'id'>): Promise<User>;
};
`,
  'file:///types/api.d.ts',
)
```

### カスタム言語の定義

```javascript
// カスタム言語の定義
monaco.languages.register({ id: 'myLanguage' })

// トークナイザーの設定
monaco.languages.setMonarchTokensProvider('myLanguage', {
  tokenizer: {
    root: [
      [/[a-z_$][\w$]*/, 'identifier'],
      [/\d+/, 'number'],
      [/"[^"]*"/, 'string'],
      [/\/\/.*$/, 'comment'],
      [/[{}()\[\]]/, '@brackets'],
      [/[=+\-*/]/, 'operator'],
    ],
  },
})

// 言語の設定
monaco.languages.setLanguageConfiguration('myLanguage', {
  comments: {
    lineComment: '//',
    blockComment: ['/*', '*/'],
  },
  brackets: [
    ['{', '}'],
    ['[', ']'],
    ['(', ')'],
  ],
  autoClosingPairs: [
    { open: '{', close: '}' },
    { open: '[', close: ']' },
    { open: '(', close: ')' },
    { open: '"', close: '"' },
  ],
})
```

## 高度な機能の実装

### 自動補完の実装

```javascript
// 自動補完プロバイダーの登録
monaco.languages.registerCompletionItemProvider('javascript', {
  provideCompletionItems: (model, position) => {
    const suggestions = [
      {
        label: 'console',
        kind: monaco.languages.CompletionItemKind.Function,
        insertText: 'console',
        documentation: 'Console object for logging',
      },
      {
        label: 'setTimeout',
        kind: monaco.languages.CompletionItemKind.Function,
        insertText: 'setTimeout(${1:callback}, ${2:delay})',
        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
        documentation: 'Execute a function after a delay',
      },
      {
        label: 'fetch',
        kind: monaco.languages.CompletionItemKind.Function,
        insertText: 'fetch(${1:url})',
        insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,
        documentation: 'Fetch data from a URL',
      },
    ]

    return { suggestions }
  },
})
```

### エラー検出とマーキング

```javascript
// エラーマーカーの設定
const markers = [
  {
    startLineNumber: 1,
    startColumn: 1,
    endLineNumber: 1,
    endColumn: 10,
    message: 'Syntax error: unexpected token',
    severity: monaco.MarkerSeverity.Error,
  },
  {
    startLineNumber: 2,
    startColumn: 1,
    endLineNumber: 2,
    endColumn: 5,
    message: 'Warning: unused variable',
    severity: monaco.MarkerSeverity.Warning,
  },
]

monaco.editor.setModelMarkers(editor.getModel(), 'owner', markers)
```

### コードフォーマッターの実装

```javascript
// フォーマッターの登録
monaco.languages.registerDocumentFormattingEditProvider('javascript', {
  provideDocumentFormattingEdits: (model, options) => {
    // 簡単なフォーマッターの例
    const text = model.getValue()
    const formatted = text
      .replace(/;\s*/g, ';\n')
      .replace(/{\s*/g, '{\n  ')
      .replace(/}\s*/g, '\n}\n')
      .trim()

    return [
      {
        range: model.getFullModelRange(),
        text: formatted,
      },
    ]
  },
})

// フォーマットの実行
editor.getAction('editor.action.formatDocument').run()
```

## イベントハンドリング

### エディタイベントの監視

```javascript
// テキスト変更の監視
editor.onDidChangeModelContent((event) => {
  console.log('テキストが変更されました:', event)

  // 変更内容の取得
  const changes = event.changes
  changes.forEach((change) => {
    console.log('変更範囲:', change.range)
    console.log('変更テキスト:', change.text)
  })
})

// カーソル位置の監視
editor.onDidChangeCursorPosition((event) => {
  const position = event.position
  console.log(`カーソル位置: 行${position.lineNumber}, 列${position.column}`)
})

// 選択範囲の監視
editor.onDidChangeCursorSelection((event) => {
  const selection = event.selection
  console.log('選択範囲:', selection)
})

// フォーカスの監視
editor.onDidFocusEditorText(() => {
  console.log('エディタにフォーカスが当たりました')
})

editor.onDidBlurEditorText(() => {
  console.log('エディタからフォーカスが外れました')
})
```

### キーボードショートカットの追加

```javascript
// カスタムキーバインドの追加
editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyS, () => {
  console.log('Ctrl+S が押されました')
  // 保存処理
  saveContent()
})

editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyF, () => {
  console.log('Ctrl+F が押されました')
  // 検索処理
  editor.getAction('actions.find').run()
})

// カスタムアクションの追加
editor.addAction({
  id: 'my-custom-action',
  label: 'カスタムアクション',
  keybindings: [monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyK],
  run: (editor) => {
    const selection = editor.getSelection()
    if (selection) {
      const text = editor.getModel().getValueInRange(selection)
      console.log('選択されたテキスト:', text)
    }
  },
})
```

## 実践的なアプリケーション例

### コードエディタアプリの作成

```html
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>コードエディタアプリ</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
      }

      .toolbar {
        background: #2d2d30;
        color: white;
        padding: 10px;
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .toolbar select,
      .toolbar button {
        padding: 5px 10px;
        border: none;
        border-radius: 3px;
        background: #3c3c3c;
        color: white;
      }

      .toolbar button:hover {
        background: #4c4c4c;
      }

      #editor {
        width: 100%;
        height: calc(100vh - 60px);
      }

      .status-bar {
        background: #007acc;
        color: white;
        padding: 5px 10px;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="toolbar">
      <select id="language-selector">
        <option value="javascript">JavaScript</option>
        <option value="typescript">TypeScript</option>
        <option value="python">Python</option>
        <option value="html">HTML</option>
        <option value="css">CSS</option>
      </select>

      <select id="theme-selector">
        <option value="vs">Light</option>
        <option value="vs-dark">Dark</option>
        <option value="hc-black">High Contrast</option>
      </select>

      <button onclick="formatCode()">フォーマット</button>
      <button onclick="runCode()">実行</button>
      <button onclick="saveCode()">保存</button>
    </div>

    <div id="editor"></div>

    <div class="status-bar">
      <span id="status">準備完了</span>
    </div>

    <script src="https://unpkg.com/monaco-editor@0.44.0/min/vs/loader.js"></script>
    <script>
      let editor

      require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.44.0/min/vs' } })

      require(['vs/editor/editor.main'], function () {
        // エディタの初期化
        editor = monaco.editor.create(document.getElementById('editor'), {
          value: `// JavaScript コードをここに書いてください
function greet(name) {
    return \`Hello, \${name}!\`;
}

console.log(greet('Monaco Editor'));`,
          language: 'javascript',
          theme: 'vs-dark',
          automaticLayout: true,
          minimap: { enabled: true },
          wordWrap: 'on',
        })

        // イベントリスナーの設定
        setupEventListeners()
      })

      function setupEventListeners() {
        // 言語変更
        document.getElementById('language-selector').addEventListener('change', (e) => {
          monaco.editor.setModelLanguage(editor.getModel(), e.target.value)
          updateStatus(`言語を ${e.target.value} に変更しました`)
        })

        // テーマ変更
        document.getElementById('theme-selector').addEventListener('change', (e) => {
          monaco.editor.setTheme(e.target.value)
          updateStatus(`テーマを ${e.target.value} に変更しました`)
        })

        // カーソル位置の監視
        editor.onDidChangeCursorPosition((event) => {
          const pos = event.position
          updateStatus(`行: ${pos.lineNumber}, 列: ${pos.column}`)
        })
      }

      function formatCode() {
        editor.getAction('editor.action.formatDocument').run()
        updateStatus('コードをフォーマットしました')
      }

      function runCode() {
        const code = editor.getValue()
        try {
          // 注意: 実際のアプリケーションでは、サンドボックス環境で実行してください
          eval(code)
          updateStatus('コードを実行しました')
        } catch (error) {
          updateStatus(`エラー: ${error.message}`)
        }
      }

      function saveCode() {
        const code = editor.getValue()
        const blob = new Blob([code], { type: 'text/plain' })
        const url = URL.createObjectURL(blob)
        const a = document.createElement('a')
        a.href = url
        a.download = 'code.js'
        a.click()
        URL.revokeObjectURL(url)
        updateStatus('コードを保存しました')
      }

      function updateStatus(message) {
        document.getElementById('status').textContent = message
      }
    </script>
  </body>
</html>
```

## まとめ

Monaco Editorは、Webアプリケーションに高機能なコードエディタを組み込むための強力なツールです。主なポイントは以下の通りです：

- **簡単な導入**: CDNまたはnpmで簡単に導入可能
- **豊富な機能**: シンタックスハイライト、自動補完、エラー検出
- **高いカスタマイズ性**: テーマ、言語、機能を自由に設定
- **イベント駆動**: 豊富なイベントAPIでインタラクティブな機能を実装
- **VS Code互換**: 使い慣れたエディタ体験をWebで提供

Monaco Editorを使用することで、ユーザーにとって使いやすいコードエディタをWebアプリケーションに組み込むことができます。

## 次のステップ

- カスタム言語サポートの実装
- 複数ファイルエディタの構築
- リアルタイムコラボレーション機能
- プラグインシステムの設計
- パフォーマンス最適化のテクニック
