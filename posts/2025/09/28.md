---
date: 2025-09-28
title: Playwright入門完全ガイド：E2Eテストの新定番を初心者向けに解説
description: Playwrightの基本から実践的な使い方まで、初心者向けに分かりやすく解説。クロスブラウザテスト、自動化、CI/CD連携など、現代的なWebアプリケーションのテスト戦略を実際のコード例と共に詳しく説明する。
tags:
    - playwright
    - e2e-testing
    - automation
    - testing
    - web-development
    - javascript
    - typescript
    - ci-cd
prev:
    text: "Ruby on Rails入門完全ガイド：Webアプリ開発の定番フレームワークを初心者向けに解説"
    link: "/posts/2025/09/26"
next: false
---

# Playwright入門完全ガイド：E2Eテストの新定番を初心者向けに解説

[Playwright](https://playwright.dev/)は、Microsoftが開発した現代的なWebアプリケーションのE2E（End-to-End）テストフレームワークです。クロスブラウザ対応、高速実行、安定性の高さから、多くの企業やオープンソースプロジェクトで採用されています。初心者にも分かりやすいPlaywrightの基本から実践的な使い方まで詳しく解説します。

## Playwrightとは何か

Playwrightは、Webアプリケーションの動作を自動的にテストするためのツールです。以下の特徴があります：

- **クロスブラウザ対応**: Chromium、Firefox、WebKit（Safari）でテスト可能
- **クロスプラットフォーム**: Windows、Linux、macOSで動作
- **多言語対応**: TypeScript、JavaScript、Python、.NET、Java
- **高速実行**: 並列実行とブラウザコンテキストの効率的な管理
- **安定性**: 自動待機とリトライ機能でフレイキーなテストを防止
- **豊富な機能**: スクリーンショット、動画録画、トレース機能

## Playwrightのインストール

### Node.jsプロジェクトでのインストール

```bash
# npmを使用
npm init playwright@latest

# yarnを使用
yarn create playwright

# pnpmを使用
pnpm create playwright
```

### 手動インストール

```bash
# プロジェクトにPlaywrightを追加
npm install --save-dev @playwright/test

# ブラウザのインストール
npx playwright install
```

### 設定ファイルの生成

```bash
# 初期設定ファイルの生成
npx playwright init
```

## 基本的な設定

### playwright.config.ts

```typescript
// playwright.config.ts
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  // テストファイルの場所
  testDir: './tests',
  
  // 並列実行の設定
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  
  // レポート設定
  reporter: 'html',
  
  // グローバル設定
  use: {
    // ベースURL
    baseURL: 'http://localhost:3000',
    
    // トレース設定
    trace: 'on-first-retry',
    
    // スクリーンショット設定
    screenshot: 'only-on-failure',
    
    // 動画録画設定
    video: 'retain-on-failure',
  },

  // プロジェクト設定（複数ブラウザでのテスト）
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
    // モバイルテスト
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] },
    },
    {
      name: 'Mobile Safari',
      use: { ...devices['iPhone 12'] },
    },
  ],

  // 開発サーバーの設定
  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
  },
});
```

## 基本的なテストの書き方

### シンプルなテスト例

```typescript
// tests/example.spec.ts
import { test, expect } from '@playwright/test';

test('ホームページの表示確認', async ({ page }) => {
  // ページにアクセス
  await page.goto('/');
  
  // タイトルの確認
  await expect(page).toHaveTitle(/My App/);
  
  // 要素の存在確認
  await expect(page.locator('h1')).toBeVisible();
  
  // テキストの確認
  await expect(page.locator('h1')).toContainText('Welcome');
});
```

### フォーム操作のテスト

```typescript
// tests/form.spec.ts
import { test, expect } from '@playwright/test';

test('ユーザー登録フォームのテスト', async ({ page }) => {
  await page.goto('/register');
  
  // フォームの入力
  await page.fill('input[name="name"]', '田中太郎');
  await page.fill('input[name="email"]', 'tanaka@example.com');
  await page.fill('input[name="password"]', 'password123');
  
  // チェックボックスの選択
  await page.check('input[name="terms"]');
  
  // ボタンのクリック
  await page.click('button[type="submit"]');
  
  // 成功メッセージの確認
  await expect(page.locator('.success-message')).toBeVisible();
  await expect(page.locator('.success-message')).toContainText('登録が完了しました');
});
```

### ナビゲーションテスト

```typescript
// tests/navigation.spec.ts
import { test, expect } from '@playwright/test';

test('ナビゲーションメニューのテスト', async ({ page }) => {
  await page.goto('/');
  
  // メニュー項目のクリック
  await page.click('nav a[href="/about"]');
  
  // URLの確認
  await expect(page).toHaveURL('/about');
  
  // ページタイトルの確認
  await expect(page.locator('h1')).toContainText('About Us');
  
  // 戻るボタンのテスト
  await page.click('a[href="/"]');
  await expect(page).toHaveURL('/');
});
```

## 高度なテストパターン

### 認証が必要なテスト

```typescript
// tests/auth.spec.ts
import { test, expect } from '@playwright/test';

// 認証状態を保存するテスト
test('ログイン状態の保存', async ({ browser }) => {
  const context = await browser.newContext();
  const page = await context.newPage();
  
  // ログイン処理
  await page.goto('/login');
  await page.fill('input[name="email"]', 'user@example.com');
  await page.fill('input[name="password"]', 'password123');
  await page.click('button[type="submit"]');
  
  // ログイン成功の確認
  await expect(page.locator('.user-menu')).toBeVisible();
  
  // 認証状態を保存
  await context.storageState({ path: 'auth.json' });
  
  await context.close();
});

// 保存した認証状態を使用するテスト
test('認証が必要なページのテスト', async ({ browser }) => {
  const context = await browser.newContext({ 
    storageState: 'auth.json' 
  });
  const page = await context.newPage();
  
  await page.goto('/dashboard');
  
  // 認証済みユーザーのみ見える要素の確認
  await expect(page.locator('.dashboard-content')).toBeVisible();
  
  await context.close();
});
```

### APIモックの使用

```typescript
// tests/api-mock.spec.ts
import { test, expect } from '@playwright/test';

test('APIレスポンスのモック', async ({ page }) => {
  // APIレスポンスをモック
  await page.route('**/api/users', async route => {
    const json = [
      { id: 1, name: '田中太郎', email: 'tanaka@example.com' },
      { id: 2, name: '佐藤花子', email: 'sato@example.com' }
    ];
    await route.fulfill({ json });
  });
  
  await page.goto('/users');
  
  // モックされたデータの表示確認
  await expect(page.locator('.user-list')).toBeVisible();
  await expect(page.locator('.user-item')).toHaveCount(2);
  await expect(page.locator('.user-item').first()).toContainText('田中太郎');
});
```

### 複数タブのテスト

```typescript
// tests/multi-tab.spec.ts
import { test, expect } from '@playwright/test';

test('複数タブでの操作', async ({ context }) => {
  // 最初のタブ
  const page1 = await context.newPage();
  await page1.goto('/');
  
  // 新しいタブを開く
  const page2 = await context.newPage();
  await page2.goto('/about');
  
  // 両方のタブで操作
  await page1.click('nav a[href="/contact"]');
  await page2.click('nav a[href="/products"]');
  
  // 各タブの状態確認
  await expect(page1).toHaveURL('/contact');
  await expect(page2).toHaveURL('/products');
  
  await page1.close();
  await page2.close();
});
```

## セレクターの使い方

### 基本的なセレクター

```typescript
// tests/selectors.spec.ts
import { test, expect } from '@playwright/test';

test('セレクターの使い方', async ({ page }) => {
  await page.goto('/');
  
  // CSSセレクター
  await page.click('.button-primary');
  await page.fill('#email-input', 'test@example.com');
  
  // テキストセレクター
  await page.click('text=ログイン');
  await page.click('text=/登録/'); // 正規表現
  
  // 属性セレクター
  await page.click('[data-testid="submit-button"]');
  await page.fill('[placeholder="メールアドレス"]', 'test@example.com');
  
  // ロケーターの使用
  const submitButton = page.locator('button[type="submit"]');
  await submitButton.click();
  
  // 複数要素の操作
  const buttons = page.locator('.action-button');
  await expect(buttons).toHaveCount(3);
  await buttons.first().click();
});
```

### カスタムセレクター

```typescript
// tests/custom-selectors.spec.ts
import { test, expect } from '@playwright/test';

test('カスタムセレクターの使用', async ({ page }) => {
  await page.goto('/');
  
  // データ属性を使用
  await page.click('[data-testid="user-menu"]');
  
  // ロールベースのセレクター
  await page.click('role=button[name="保存"]');
  await page.fill('role=textbox[name="タイトル"]', 'テストタイトル');
  
  // ラベルベースのセレクター
  await page.fill('label:has-text("メールアドレス") input', 'test@example.com');
  
  // 複合セレクター
  await page.click('.form-group:has(label:has-text("同意")) input[type="checkbox"]');
});
```

## アサーション（検証）

### 基本的なアサーション

```typescript
// tests/assertions.spec.ts
import { test, expect } from '@playwright/test';

test('アサーションの使い方', async ({ page }) => {
  await page.goto('/');
  
  // 要素の存在確認
  await expect(page.locator('h1')).toBeVisible();
  await expect(page.locator('.hidden-element')).toBeHidden();
  
  // テキストの確認
  await expect(page.locator('h1')).toHaveText('Welcome to My App');
  await expect(page.locator('.description')).toContainText('アプリケーション');
  
  // 属性の確認
  await expect(page.locator('input[type="email"]')).toHaveAttribute('required');
  await expect(page.locator('img')).toHaveAttribute('alt', 'ロゴ');
  
  // CSSプロパティの確認
  await expect(page.locator('.error-message')).toHaveCSS('color', 'rgb(255, 0, 0)');
  
  // 要素数の確認
  await expect(page.locator('.list-item')).toHaveCount(5);
  
  // URLの確認
  await expect(page).toHaveURL('/');
  await expect(page).toHaveURL(/localhost:3000/);
  
  // タイトルの確認
  await expect(page).toHaveTitle('My App');
  await expect(page).toHaveTitle(/My App/);
});
```

### カスタムアサーション

```typescript
// tests/custom-assertions.spec.ts
import { test, expect } from '@playwright/test';

test('カスタムアサーション', async ({ page }) => {
  await page.goto('/');
  
  // 要素の状態確認
  const button = page.locator('button[type="submit"]');
  await expect(button).toBeEnabled();
  await expect(button).toBeDisabled();
  
  // フォーカスの確認
  await page.focus('input[name="email"]');
  await expect(page.locator('input[name="email"]')).toBeFocused();
  
  // チェックボックスの状態確認
  await expect(page.locator('input[type="checkbox"]')).toBeChecked();
  await expect(page.locator('input[type="checkbox"]')).not.toBeChecked();
  
  // セレクトボックスの値確認
  await expect(page.locator('select[name="category"]')).toHaveValue('general');
  
  // ファイル入力の確認
  await expect(page.locator('input[type="file"]')).toHaveValue('');
});
```

## 実践的なテスト例

### ブログアプリケーションのテスト

```typescript
// tests/blog.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ブログアプリケーション', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/');
  });

  test('記事一覧の表示', async ({ page }) => {
    // 記事一覧ページに移動
    await page.click('nav a[href="/articles"]');
    
    // 記事一覧の表示確認
    await expect(page.locator('.article-list')).toBeVisible();
    await expect(page.locator('.article-item')).toHaveCount.greaterThan(0);
    
    // 記事タイトルの表示確認
    const firstArticle = page.locator('.article-item').first();
    await expect(firstArticle.locator('.article-title')).toBeVisible();
    await expect(firstArticle.locator('.article-excerpt')).toBeVisible();
  });

  test('記事の詳細表示', async ({ page }) => {
    await page.goto('/articles');
    
    // 最初の記事をクリック
    await page.click('.article-item:first-child .article-title a');
    
    // 記事詳細ページの表示確認
    await expect(page.locator('.article-detail')).toBeVisible();
    await expect(page.locator('.article-title')).toBeVisible();
    await expect(page.locator('.article-content')).toBeVisible();
    await expect(page.locator('.article-meta')).toBeVisible();
  });

  test('記事の作成', async ({ page }) => {
    // ログイン（認証が必要な場合）
    await page.goto('/login');
    await page.fill('input[name="email"]', 'admin@example.com');
    await page.fill('input[name="password"]', 'password123');
    await page.click('button[type="submit"]');
    
    // 記事作成ページに移動
    await page.click('nav a[href="/articles/new"]');
    
    // フォームの入力
    await page.fill('input[name="title"]', 'テスト記事');
    await page.fill('textarea[name="content"]', 'これはテスト記事の内容です。');
    await page.selectOption('select[name="category"]', 'technology');
    
    // 記事の保存
    await page.click('button[type="submit"]');
    
    // 成功メッセージの確認
    await expect(page.locator('.success-message')).toBeVisible();
    await expect(page.locator('.success-message')).toContainText('記事が作成されました');
    
    // 記事一覧に戻って確認
    await page.click('nav a[href="/articles"]');
    await expect(page.locator('.article-item:first-child')).toContainText('テスト記事');
  });

  test('記事の検索', async ({ page }) => {
    await page.goto('/articles');
    
    // 検索フォームの入力
    await page.fill('input[name="search"]', 'JavaScript');
    await page.click('button[type="submit"]');
    
    // 検索結果の確認
    await expect(page.locator('.search-results')).toBeVisible();
    await expect(page.locator('.article-item')).toHaveCount.greaterThan(0);
    
    // 検索結果の内容確認
    const searchResults = page.locator('.article-item');
    for (let i = 0; i < await searchResults.count(); i++) {
      const article = searchResults.nth(i);
      await expect(article).toContainText(/JavaScript/i);
    }
  });
});
```

## CI/CDでの実行

### GitHub Actionsでの設定

```yaml
# .github/workflows/playwright.yml
name: Playwright Tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - uses: actions/setup-node@v4
      with:
        node-version: 18
        
    - name: Install dependencies
      run: npm ci
      
    - name: Install Playwright Browsers
      run: npx playwright install --with-deps
      
    - name: Run Playwright tests
      run: npx playwright test
      
    - uses: actions/upload-artifact@v4
      if: always()
      with:
        name: playwright-report
        path: playwright-report/
        retention-days: 30
```

### パフォーマンステスト

```typescript
// tests/performance.spec.ts
import { test, expect } from '@playwright/test';

test('ページの読み込み速度テスト', async ({ page }) => {
  // パフォーマンス測定の開始
  await page.goto('/');
  
  // ページの読み込み完了を待つ
  await page.waitForLoadState('networkidle');
  
  // パフォーマンスメトリクスの取得
  const performanceMetrics = await page.evaluate(() => {
    const navigation = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;
    return {
      loadTime: navigation.loadEventEnd - navigation.loadEventStart,
      domContentLoaded: navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart,
      firstPaint: performance.getEntriesByName('first-paint')[0]?.startTime || 0,
      firstContentfulPaint: performance.getEntriesByName('first-contentful-paint')[0]?.startTime || 0,
    };
  });
  
  // パフォーマンスの検証
  expect(performanceMetrics.loadTime).toBeLessThan(3000); // 3秒以内
  expect(performanceMetrics.domContentLoaded).toBeLessThan(2000); // 2秒以内
  expect(performanceMetrics.firstContentfulPaint).toBeLessThan(1500); // 1.5秒以内
});
```

## デバッグとトラブルシューティング

### デバッグモードでの実行

```bash
# デバッグモードでテストを実行
npx playwright test --debug

# 特定のテストをデバッグ
npx playwright test tests/example.spec.ts --debug

# ヘッドフルモードで実行
npx playwright test --headed

# 特定のブラウザで実行
npx playwright test --project=chromium
```

### トレースの確認

```bash
# トレースレポートの表示
npx playwright show-trace trace.zip

# HTMLレポートの表示
npx playwright show-report
```

## まとめ

Playwrightは、現代的なWebアプリケーションのE2Eテストに最適なツールです。主なポイントは以下の通りです：

- **クロスブラウザ対応**: 複数のブラウザで一貫したテストが可能
- **高速実行**: 並列実行と効率的なブラウザ管理
- **安定性**: 自動待機とリトライ機能でフレイキーなテストを防止
- **豊富な機能**: スクリーンショット、動画録画、トレース機能
- **多言語対応**: TypeScript、JavaScript、Python、.NET、Java
- **CI/CD連携**: GitHub Actions等での自動実行が容易

Playwrightを学ぶことで、信頼性の高いWebアプリケーションを構築し、継続的な品質向上を実現できます。

## 次のステップ

- より複雑なテストシナリオの実装
- パフォーマンステストの詳細
- モバイルアプリのテスト
- カスタムレポーターの作成
- テストデータの管理
- 並列実行の最適化
