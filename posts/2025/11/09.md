---
date: 2025-11-09
title: TypeScriptのOpenAPIエコシステム完全ガイド：型安全なAPI開発の実践
description: TypeScriptでOpenAPIを活用するためのエコシステムを詳しく解説。openapi-typescript、openapi-generator、swagger-codegen、zod-openapiなど、主要なツールとライブラリの特徴、使い分け、実践的な導入方法をコード例と共に紹介します。
tags:
  - typescript
  - openapi
  - api-development
  - code-generation
  - type-safety
  - swagger
  - rest-api
prev:
  text: 'フロントエンドでCookieを扱うベストプラクティス'
  link: '/posts/2025/11/07'
next:
  text: 'APIリクエストを型安全にする実践的手法：TypeScriptで堅牢なAPI通信を実現'
  link: '/posts/2025/11/10'
---

# TypeScriptのOpenAPIエコシステム完全ガイド：型安全なAPI開発の実践

[OpenAPI](https://www.openapis.org/)は、HTTP APIを記述するための標準仕様です。TypeScriptと組み合わせることで、型安全なAPI開発が可能になります。この記事では、TypeScriptのOpenAPIエコシステムでよく使われるツールとライブラリを、実践的なコード例と共に詳しく解説します。

## OpenAPIとは

OpenAPI（旧Swagger）は、RESTful APIの構造を記述するための標準フォーマットです。YAMLまたはJSON形式でAPIのエンドポイント、リクエスト/レスポンスの型、認証方法などを定義できます。

### OpenAPIのメリット

- **型安全性**: スキーマから型定義を自動生成できる
- **ドキュメント**: API仕様が自動的にドキュメントになる
- **コード生成**: クライアント/サーバーコードを自動生成できる
- **検証**: リクエスト/レスポンスのバリデーションが可能

## TypeScript向けの主要ツール

### 1. openapi-typescript

OpenAPIスキーマからTypeScriptの型定義を生成するツールです。軽量で高速、依存関係が少ないのが特徴です。

#### インストール

```bash
npm install -D openapi-typescript
```

#### 基本的な使い方

```bash
# OpenAPIスキーマから型定義を生成
npx openapi-typescript schema.yaml -o types/api.d.ts
```

#### 生成される型定義の例

```typescript
// types/api.d.ts
export interface paths {
  '/users': {
    get: {
      responses: {
        200: {
          content: {
            'application/json': {
              users: {
                id: number
                name: string
                email: string
              }[]
            }
          }
        }
      }
    }
    post: {
      requestBody: {
        content: {
          'application/json': {
            name: string
            email: string
          }
        }
      }
      responses: {
        201: {
          content: {
            'application/json': {
              id: number
              name: string
              email: string
            }
          }
        }
      }
    }
  }
}
```

#### 使用例

```typescript
import type { paths } from './types/api'

type GetUsersResponse = paths['/users']['get']['responses']['200']['content']['application/json']
type CreateUserRequest = paths['/users']['post']['requestBody']['content']['application/json']

async function getUsers(): Promise<GetUsersResponse> {
  const response = await fetch('/users')
  return response.json()
}

async function createUser(data: CreateUserRequest): Promise<void> {
  await fetch('/users', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data),
  })
}
```

### 2. openapi-fetch

openapi-typescriptと組み合わせて使う、型安全なfetchラッパーです。

#### インストール

```bash
npm install openapi-fetch
```

#### 使用例

```typescript
import createClient from 'openapi-fetch'
import type { paths } from './types/api'

const client = createClient<paths>({ baseUrl: 'https://api.example.com' })

// 型安全なAPI呼び出し
const { data, error } = await client.GET('/users')
if (data) {
  // dataは自動的に型推論される
  console.log(data.users)
}

const { data: user } = await client.POST('/users', {
  body: {
    name: 'John Doe',
    email: 'john@example.com',
  },
})
```

### 3. @openapitools/openapi-generator

OpenAPIスキーマからクライアント/サーバーコードを生成するツールです。

#### インストール

```bash
npm install -D @openapitools/openapi-generator-cli
```

#### 基本的な使い方

```bash
# TypeScriptクライアントを生成
npx @openapitools/openapi-generator-cli generate \
  -i schema.yaml \
  -g typescript-axios \
  -o ./generated/client
```

#### 生成されるコードの特徴

- 型安全なAPIクライアント
- リクエスト/レスポンスのバリデーション
- 認証ヘッダーの自動付与
- エラーハンドリング

### 4. zod-openapi

ZodスキーマからOpenAPI仕様を生成し、ランタイムバリデーションも行えるライブラリです。

#### インストール

```bash
npm install zod-openapi zod
```

#### 使用例

```typescript
import { createDocument, z } from 'zod-openapi'

// Zodスキーマを定義
const UserSchema = z.object({
  id: z.number(),
  name: z.string(),
  email: z.string().email(),
})

const CreateUserSchema = z.object({
  name: z.string().min(1),
  email: z.string().email(),
})

// OpenAPIドキュメントを作成
const document = createDocument({
  openapi: '3.0.0',
  info: {
    title: 'User API',
    version: '1.0.0',
  },
  paths: {
    '/users': {
      get: {
        responses: {
          '200': {
            description: 'ユーザー一覧',
            content: {
              'application/json': {
                schema: z.array(UserSchema),
              },
            },
          },
        },
      },
      post: {
        requestBody: {
          content: {
            'application/json': {
              schema: CreateUserSchema,
            },
          },
        },
        responses: {
          '201': {
            description: 'ユーザー作成成功',
            content: {
              'application/json': {
                schema: UserSchema,
              },
            },
          },
        },
      },
    },
  },
})

// ランタイムバリデーション
function validateCreateUser(data: unknown) {
  return CreateUserSchema.parse(data)
}
```

### 5. swagger-jsdoc + swagger-ui-express

既存のコードにJSDocコメントを追加してOpenAPI仕様を生成する方法です。

#### インストール

```bash
npm install swagger-jsdoc swagger-ui-express
npm install -D @types/swagger-jsdoc @types/swagger-ui-express
```

#### 使用例

```typescript
import swaggerJsdoc from 'swagger-jsdoc'
import swaggerUi from 'swagger-ui-express'

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'User API',
      version: '1.0.0',
    },
  },
  apis: ['./src/routes/*.ts'],
}

const swaggerSpec = swaggerJsdoc(options)

// Expressで使用
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerSpec))
```

```typescript
/**
 * @swagger
 * /users:
 *   get:
 *     summary: ユーザー一覧を取得
 *     responses:
 *       200:
 *         description: 成功
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 $ref: '#/components/schemas/User'
 */
app.get('/users', (req, res) => {
  // 実装
})
```

## ツールの選び方

### 軽量で型定義のみ必要な場合

**推奨**: `openapi-typescript` + `openapi-fetch`

- 依存関係が少ない
- ビルドが高速
- 型安全性を重視する場合に最適

### フル機能のクライアントが必要な場合

**推奨**: `@openapitools/openapi-generator`

- バリデーション、認証、エラーハンドリングが組み込まれている
- 複数の言語に対応
- エンタープライズ向け

### スキーマファーストで開発する場合

**推奨**: `zod-openapi`

- ZodスキーマからOpenAPIを生成
- ランタイムバリデーションも可能
- 単一のソースから型とバリデーションを管理

### 既存コードに追加する場合

**推奨**: `swagger-jsdoc`

- 既存のコードにコメントを追加するだけ
- 段階的な導入が可能
- ドキュメント生成が簡単

## 実践的なワークフロー

### スキーマファースト開発

1. OpenAPIスキーマを先に定義
2. 型定義を自動生成
3. クライアント/サーバーコードを実装

```bash
# 1. スキーマを定義
# schema.yaml

# 2. 型定義を生成
npx openapi-typescript schema.yaml -o types/api.d.ts

# 3. クライアントを生成（必要に応じて）
npx @openapitools/openapi-generator-cli generate \
  -i schema.yaml \
  -g typescript-axios \
  -o ./generated/client
```

### コードファースト開発

1. コードを先に実装
2. JSDocコメントでOpenAPI仕様を記述
3. ドキュメントを自動生成

## まとめ

TypeScriptのOpenAPIエコシステムを活用することで、型安全で保守性の高いAPI開発が可能になります。

**主なポイント**:

- **openapi-typescript**: 軽量で高速な型定義生成
- **openapi-fetch**: 型安全なfetchラッパー
- **@openapitools/openapi-generator**: フル機能のコード生成
- **zod-openapi**: ZodスキーマからOpenAPIを生成
- **swagger-jsdoc**: 既存コードにコメントで追加

プロジェクトの要件に応じて適切なツールを選び、型安全性と開発効率を両立させましょう。
