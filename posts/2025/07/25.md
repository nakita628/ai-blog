---
date: 2025-07-25
title: Redisの基本とベストプラクティス：高速キャッシュ・セッション管理の実践例
description: Redisの特徴と活用方法を徹底解説。キャッシュ戦略、セッション管理、データ永続化、パフォーマンス最適化など、実践的なベストプラクティスとTypeScript例を交えて紹介します。
tags:
    - redis
    - cache
    - session
    - typescript
    - backend
    - performance
    - web-development
prev:
    text: "TypeScriptにおけるnullとundefinedの違いと使い分け完全ガイド"
    link: "/posts/2025/07/24"
next:
    text: "昔のアーキテクチャと現代のアーキテクチャ徹底比較：進化の本質と選択のポイント"
    link: "/posts/2025/07/26"
---
    
# Redisの基本とベストプラクティス：高速キャッシュ・セッション管理の実践例

Redisはインメモリ型の高速データストアとして、キャッシュやセッション管理、ランキング集計など多様な用途で利用されています。本記事では、Redisの基本から、実践的なベストプラクティスまでをTypeScript例とともに解説します。

## Redisの主な特徴

- インメモリ型で高速な読み書き
- キー・バリュー型データ構造
- 永続化（AOF・RDB）対応
- Pub/Subやストリーム、リスト・セット・ハッシュなど多様なデータ型
- 分散・クラスタリング対応

## キャッシュ戦略のベストプラクティス

- DBクエリ結果やAPIレスポンスをRedisにキャッシュすることで、レスポンス速度とスケーラビリティを向上
- 適切なTTL（有効期限）設定でキャッシュの鮮度を保つ

```ts
import { createClient } from 'redis';

const redis = createClient();
await redis.connect();

async function getUser(id: string): Promise<User> {
  const cacheKey = `user:${id}`;
  const cached = await redis.get(cacheKey);
  if (cached) return JSON.parse(cached);

  const user = await fetchUserFromDB(id);
  await redis.set(cacheKey, JSON.stringify(user), { EX: 3600 }); // 1時間キャッシュ
  return user;
}
```

## セッション管理のベストプラクティス

- ユーザーセッション情報をRedisで管理することで、スケールアウト時も一貫性を保てる
- セッションIDをキーにして、ユーザー情報や認証トークンを保存

```ts
async function setSession(sessionId: string, data: SessionData) {
  await redis.set(`session:${sessionId}`, JSON.stringify(data), { EX: 1800 }); // 30分
}

async function getSession(sessionId: string): Promise<SessionData | null> {
  const raw = await redis.get(`session:${sessionId}`);
  return raw ? JSON.parse(raw) : null;
}
```

## データ永続化とバックアップ

- RDB（スナップショット）とAOF（追記型ログ）の両方を組み合わせて信頼性を高める
- 定期的なバックアップと監視を推奨

## パフォーマンス最適化

- コネクションプールの活用
- パイプライン処理で複数コマンドをまとめて送信
- 適切なキー設計（プレフィックス・命名規則）

```ts
const pipeline = redis.multi();
pipeline.set('key1', 'value1');
pipeline.set('key2', 'value2');
const results = await pipeline.exec();
```

## よく使うコマンド例

- `SET` / `GET`：基本の保存・取得
- `EXPIRE`：有効期限設定
- `DEL`：キー削除
- `INCR` / `DECR`：数値インクリメント
- `LPUSH` / `LRANGE`：リスト操作
- `HSET` / `HGETALL`：ハッシュ操作

## ベストプラクティスまとめ

- キャッシュはTTLを必ず設定し、不要なデータは定期的に削除
- セッション管理はスケールアウトを前提に設計
- キー設計は一貫性・可読性を重視
- パイプラインやコネクションプールでパフォーマンスを最大化
- 永続化・バックアップ・監視を忘れずに

## まとめ

Redisは高速・柔軟・拡張性に優れたデータストアです。キャッシュやセッション管理、ランキング集計など多様な用途で活用でき、ベストプラクティスを守ることで、安定した高パフォーマンスなシステムを構築できます。
