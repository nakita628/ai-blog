---
date: 2025-10-26
title: ElysiaJS完全入門：Bun最適化のTypeScriptフレームワークで高速API開発を実現する
description: ElysiaJSの基本概念から実装方法まで、初心者向けに詳しく解説。Bun最適化のTypeScriptフレームワークとして、型安全性、OpenAPI統合、エンドツーエンド型安全性、WebSocket対応などの特徴を実践的なコード例を通じて学ぶ実践的なガイド。
tags:
  - elysiajs
  - bun
  - typescript
  - api
  - framework
  - websocket
  - openapi
  - performance
  - type-safety
prev:
  text: 'p-queue完全入門：Promiseキューの並行制御で効率的な非同期処理を実現する'
  link: '/posts/2025/10/24'
next: false
---

# ElysiaJS完全入門：Bun最適化のTypeScriptフレームワークで高速API開発を実現する

[ElysiaJS](https://elysiajs.com/)は、Bun最適化のTypeScriptフレームワークで、型安全性と優れた開発者体験を提供します。Expressの21倍、Fastifyの6倍の高速パフォーマンスを実現し、OpenAPI統合、エンドツーエンド型安全性、WebSocket対応などの先進的な機能を備えています。この記事では、ElysiaJSの基本概念から実装方法まで、実践的なコード例を通じて詳しく解説します。

## ElysiaJSとは

ElysiaJSは、Bunランタイムに最適化されたTypeScriptフレームワークです。以下の特徴を持っています：

- **高速パフォーマンス**: Expressの21倍、Fastifyの6倍の速度
- **型安全性**: エンドツーエンドの型安全性
- **OpenAPI統合**: 自動的なAPIドキュメント生成
- **WebSocket対応**: リアルタイム通信のサポート
- **バリデーション**: 複数のバリデーションライブラリに対応
- **ストリーミング**: ファイル送信とストリーミングレスポンス

### 主な特徴

- **Bun最適化**: Bunランタイムの特性を最大限活用
- **型安全性**: TypeScriptの型システムを完全活用
- **直感的なAPI**: シンプルで理解しやすいAPI設計
- **プラグインシステム**: 豊富なプラグインエコシステム
- **OpenTelemetry対応**: 監視とトレーシングのサポート

## プロジェクトのセットアップ

### 必要な環境

```bash
# Bunをインストール
curl -fsSL https://bun.sh/install | bash

# プロジェクトを作成
bun create elysia app
cd app

# 依存関係をインストール
bun install
```

### 基本的なアプリケーション

```typescript
// src/index.ts
import { Elysia } from 'elysia'

const app = new Elysia()
  .get('/', () => 'Hello World')
  .get('/health', () => ({ status: 'ok', timestamp: new Date().toISOString() }))
  .listen(3000)

console.log('Server is running on http://localhost:3000')
```

## 基本的なルーティング

### HTTPメソッドの実装

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  // GETリクエスト
  .get('/', () => 'Hello World')
  .get('/users', () => ({ users: [] }))
  .get('/users/:id', ({ params }) => ({ id: params.id, name: 'John Doe' }))

  // POSTリクエスト
  .post('/users', ({ body }) => {
    console.log('Creating user:', body)
    return { message: 'User created', user: body }
  })

  // PUTリクエスト
  .put('/users/:id', ({ params, body }) => {
    console.log(`Updating user ${params.id}:`, body)
    return { message: 'User updated', id: params.id, user: body }
  })

  // DELETEリクエスト
  .delete('/users/:id', ({ params }) => {
    console.log(`Deleting user ${params.id}`)
    return { message: 'User deleted', id: params.id }
  })

  .listen(3000)
```

### クエリパラメータとヘッダーの処理

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  .get('/search', ({ query, headers }) => {
    return {
      query: query,
      userAgent: headers['user-agent'],
      timestamp: new Date().toISOString(),
    }
  })
  .get('/users', ({ query }) => {
    const { page = 1, limit = 10, sort = 'name' } = query
    return {
      users: [],
      pagination: {
        page: Number(page),
        limit: Number(limit),
        sort,
      },
    }
  })
  .listen(3000)
```

## 型安全性とバリデーション

### 基本的なバリデーション

```typescript
import { Elysia, t } from 'elysia'

const app = new Elysia()
  .post(
    '/users',
    ({ body }) => {
      return { message: 'User created', user: body }
    },
    {
      body: t.Object({
        name: t.String({ minLength: 2, maxLength: 50 }),
        email: t.String({ format: 'email' }),
        age: t.Number({ minimum: 0, maximum: 120 }),
        isActive: t.Boolean(),
      }),
    },
  )
  .get(
    '/users/:id',
    ({ params }) => {
      return { id: params.id, name: 'John Doe' }
    },
    {
      params: t.Object({
        id: t.String({ pattern: '^[0-9]+$' }),
      }),
    },
  )
  .listen(3000)
```

### レスポンスの型定義

```typescript
import { Elysia, t } from 'elysia'

const UserSchema = t.Object({
  id: t.String(),
  name: t.String(),
  email: t.String({ format: 'email' }),
  age: t.Number(),
  createdAt: t.String({ format: 'date-time' }),
})

const app = new Elysia()
  .get(
    '/users/:id',
    ({ params }) => {
      return {
        id: params.id,
        name: 'John Doe',
        email: 'john@example.com',
        age: 30,
        createdAt: new Date().toISOString(),
      }
    },
    {
      params: t.Object({
        id: t.String(),
      }),
      response: UserSchema,
    },
  )
  .listen(3000)
```

## ミドルウェアとプラグイン

### 基本的なミドルウェア

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  // ログミドルウェア
  .onRequest(({ request }) => {
    console.log(`${request.method} ${request.url} - ${new Date().toISOString()}`)
  })
  .onResponse(({ response }) => {
    console.log(`Response: ${response.status}`)
  })

  // CORSミドルウェア
  .onRequest(({ set }) => {
    set.headers['Access-Control-Allow-Origin'] = '*'
    set.headers['Access-Control-Allow-Methods'] = 'GET, POST, PUT, DELETE, OPTIONS'
    set.headers['Access-Control-Allow-Headers'] = 'Content-Type, Authorization'
  })

  .get('/', () => 'Hello World')
  .listen(3000)
```

### カスタムプラグインの作成

```typescript
import { Elysia } from 'elysia'

// 認証プラグイン
const authPlugin = new Elysia({ name: 'auth' }).onRequest(({ request, set }) => {
  const token = request.headers.get('authorization')
  if (!token || !token.startsWith('Bearer ')) {
    set.status = 401
    return { error: 'Unauthorized' }
  }
})

// レート制限プラグイン
const rateLimitPlugin = new Elysia({ name: 'rate-limit' }).onRequest(({ request, set }) => {
  // 簡単なレート制限の実装
  const ip = request.headers.get('x-forwarded-for') || 'unknown'
  // 実際の実装では、Redisやメモリキャッシュを使用
  console.log(`Rate limiting for IP: ${ip}`)
})

const app = new Elysia()
  .use(authPlugin)
  .use(rateLimitPlugin)
  .get('/protected', () => 'Protected resource')
  .listen(3000)
```

## ファイル処理とストリーミング

### ファイルの送信

```typescript
import { Elysia, file } from 'elysia'

const app = new Elysia()
  // 静的ファイルの送信
  .get('/image', file('public/image.jpg'))
  .get('/download/:filename', ({ params }) => {
    return file(`uploads/${params.filename}`)
  })

  // ファイルアップロード
  .post('/upload', ({ body }) => {
    console.log('Uploaded file:', body)
    return { message: 'File uploaded successfully' }
  })
  .listen(3000)
```

### ストリーミングレスポンス

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  .get('/stream', function* () {
    yield 'Hello'
    yield ' '
    yield 'World'
    yield '!'
  })
  .get('/events', function* () {
    for (let i = 0; i < 10; i++) {
      yield `Event ${i + 1}\n`
      // 1秒待機
      yield new Promise((resolve) => setTimeout(resolve, 1000))
    }
  })
  .listen(3000)
```

## WebSocket対応

### 基本的なWebSocket実装

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  .ws('/realtime', {
    message(ws, message) {
      console.log('Received:', message)
      ws.send(`Echo: ${message}`)
    },
    open(ws) {
      console.log('WebSocket connection opened')
      ws.send('Welcome to the real-time chat!')
    },
    close(ws) {
      console.log('WebSocket connection closed')
    },
  })
  .listen(3000)
```

### チャットアプリケーションの実装

```typescript
import { Elysia } from 'elysia'

interface ChatMessage {
  id: string
  user: string
  message: string
  timestamp: string
}

const chatMessages: ChatMessage[] = []
const connectedClients = new Set<any>()

const app = new Elysia()
  .ws('/chat', {
    message(ws, message) {
      try {
        const data = JSON.parse(message as string)
        const chatMessage: ChatMessage = {
          id: Date.now().toString(),
          user: data.user,
          message: data.message,
          timestamp: new Date().toISOString(),
        }

        chatMessages.push(chatMessage)

        // 全クライアントにメッセージを送信
        connectedClients.forEach((client) => {
          client.send(JSON.stringify(chatMessage))
        })
      } catch (error) {
        ws.send(JSON.stringify({ error: 'Invalid message format' }))
      }
    },
    open(ws) {
      connectedClients.add(ws)
      console.log('New client connected')

      // 過去のメッセージを送信
      chatMessages.forEach((message) => {
        ws.send(JSON.stringify(message))
      })
    },
    close(ws) {
      connectedClients.delete(ws)
      console.log('Client disconnected')
    },
  })
  .get('/chat/history', () => chatMessages)
  .listen(3000)
```

## OpenAPI統合

### 基本的なOpenAPI設定

```typescript
import { Elysia } from 'elysia'
import { openapi } from '@elysiajs/openapi'

const app = new Elysia()
  .use(
    openapi({
      info: {
        title: 'My API',
        version: '1.0.0',
        description: 'A simple API built with ElysiaJS',
      },
      tags: [
        { name: 'users', description: 'User management endpoints' },
        { name: 'auth', description: 'Authentication endpoints' },
      ],
    }),
  )
  .get('/users', () => ({ users: [] }), {
    tags: ['users'],
    summary: 'Get all users',
    description: 'Retrieve a list of all users',
  })
  .post('/users', ({ body }) => ({ message: 'User created', user: body }), {
    tags: ['users'],
    summary: 'Create a new user',
    description: 'Create a new user with the provided information',
    body: t.Object({
      name: t.String(),
      email: t.String({ format: 'email' }),
    }),
  })
  .listen(3000)
```

### 詳細なOpenAPI設定

```typescript
import { Elysia, t } from 'elysia'
import { openapi } from '@elysiajs/openapi'

const UserSchema = t.Object({
  id: t.String(),
  name: t.String(),
  email: t.String({ format: 'email' }),
  createdAt: t.String({ format: 'date-time' }),
})

const CreateUserSchema = t.Object({
  name: t.String({ minLength: 2, maxLength: 50 }),
  email: t.String({ format: 'email' }),
})

const app = new Elysia()
  .use(
    openapi({
      info: {
        title: 'User Management API',
        version: '1.0.0',
        description: 'API for managing users',
        contact: {
          name: 'API Support',
          email: 'support@example.com',
        },
      },
      servers: [
        { url: 'http://localhost:3000', description: 'Development server' },
        { url: 'https://api.example.com', description: 'Production server' },
      ],
      components: {
        schemas: {
          User: UserSchema,
          CreateUser: CreateUserSchema,
        },
      },
    }),
  )
  .get('/users', () => ({ users: [] }), {
    tags: ['users'],
    summary: 'Get all users',
    description: 'Retrieve a list of all users',
    response: {
      200: t.Object({
        users: t.Array(UserSchema),
      }),
    },
  })
  .post('/users', ({ body }) => ({ message: 'User created', user: body }), {
    tags: ['users'],
    summary: 'Create a new user',
    description: 'Create a new user with the provided information',
    body: CreateUserSchema,
    response: {
      201: t.Object({
        message: t.String(),
        user: UserSchema,
      }),
    },
  })
  .listen(3000)
```

## エンドツーエンド型安全性

### Eden Treatyの使用

```typescript
// server.ts
import { Elysia, t } from 'elysia'

export const app = new Elysia()
  .get(
    '/users/:id',
    ({ params }) => {
      return {
        id: params.id,
        name: 'John Doe',
        email: 'john@example.com',
      }
    },
    {
      params: t.Object({
        id: t.String(),
      }),
      response: t.Object({
        id: t.String(),
        name: t.String(),
        email: t.String(),
      }),
    },
  )
  .listen(3000)

export type App = typeof app
```

```typescript
// client.ts
import { treaty } from '@elysiajs/eden'
import type { App } from './server'

const api = treaty<App>('http://localhost:3000')

// 型安全なAPI呼び出し
const { data, error } = await api.users({ id: '123' }).get()

if (data) {
  console.log(data.id) // string
  console.log(data.name) // string
  console.log(data.email) // string
}
```

## データベース統合

### Drizzle ORMとの統合

```typescript
import { Elysia, t } from 'elysia'
import { drizzle } from 'drizzle-orm/bun-sqlite'
import { Database } from 'bun:sqlite'
import { users, insertUserSchema, selectUserSchema } from './schema'

const db = drizzle(new Database('app.db'))

const app = new Elysia()
  .get('/users', async () => {
    const allUsers = await db.select().from(users)
    return { users: allUsers }
  })
  .get(
    '/users/:id',
    async ({ params }) => {
      const user = await db.select().from(users).where(eq(users.id, params.id)).get()
      if (!user) {
        return { error: 'User not found' }
      }
      return user
    },
    {
      params: t.Object({
        id: t.String(),
      }),
    },
  )
  .post(
    '/users',
    async ({ body }) => {
      const newUser = await db.insert(users).values(body).returning().get()
      return { message: 'User created', user: newUser }
    },
    {
      body: insertUserSchema,
    },
  )
  .listen(3000)
```

## エラーハンドリング

### 基本的なエラーハンドリング

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  .onError(({ error, set }) => {
    console.error('Error:', error)

    if (error.message === 'User not found') {
      set.status = 404
      return { error: 'User not found' }
    }

    set.status = 500
    return { error: 'Internal server error' }
  })
  .get('/users/:id', ({ params }) => {
    if (params.id === 'invalid') {
      throw new Error('User not found')
    }
    return { id: params.id, name: 'John Doe' }
  })
  .listen(3000)
```

### カスタムエラークラス

```typescript
import { Elysia } from 'elysia'

class AppError extends Error {
  constructor(
    message: string,
    public statusCode: number = 500,
    public code?: string,
  ) {
    super(message)
    this.name = 'AppError'
  }
}

const app = new Elysia()
  .onError(({ error, set }) => {
    if (error instanceof AppError) {
      set.status = error.statusCode
      return {
        error: error.message,
        code: error.code,
      }
    }

    set.status = 500
    return { error: 'Internal server error' }
  })
  .get('/users/:id', ({ params }) => {
    if (params.id === 'invalid') {
      throw new AppError('User not found', 404, 'USER_NOT_FOUND')
    }
    return { id: params.id, name: 'John Doe' }
  })
  .listen(3000)
```

## テスト

### 基本的なテスト

```typescript
import { describe, it, expect } from 'bun:test'
import { treaty } from '@elysiajs/eden'
import { app } from './index'

const api = treaty(app)

describe('User API', () => {
  it('should get user by id', async () => {
    const { data, error } = await api.users({ id: '123' }).get()

    expect(error).toBeNull()
    expect(data).toEqual({
      id: '123',
      name: 'John Doe',
      email: 'john@example.com',
    })
  })

  it('should return 404 for invalid user', async () => {
    const { data, error } = await api.users({ id: 'invalid' }).get()

    expect(data).toBeNull()
    expect(error?.value).toEqual({
      error: 'User not found',
      code: 'USER_NOT_FOUND',
    })
  })
})
```

## 本番環境でのデプロイ

### Docker設定

```dockerfile
# Dockerfile
FROM oven/bun:1 as base
WORKDIR /app

# 依存関係をインストール
COPY package.json bun.lockb ./
RUN bun install --frozen-lockfile

# アプリケーションコードをコピー
COPY . .

# アプリケーションをビルド
RUN bun run build

# 本番用イメージ
FROM oven/bun:1-slim
WORKDIR /app

# 本番用ファイルをコピー
COPY --from=base /app/dist ./dist
COPY --from=base /app/package.json ./

# ポートを公開
EXPOSE 3000

# アプリケーションを起動
CMD ["bun", "run", "dist/index.js"]
```

### 環境変数の設定

```typescript
import { Elysia } from 'elysia'

const app = new Elysia()
  .get('/config', () => {
    return {
      environment: process.env.NODE_ENV || 'development',
      port: process.env.PORT || 3000,
      databaseUrl: process.env.DATABASE_URL,
    }
  })
  .listen(process.env.PORT || 3000)
```

## まとめ

ElysiaJSは、Bun最適化のTypeScriptフレームワークとして、以下の特徴を持っています：

### 主要な特徴

- **高速パフォーマンス**: Expressの21倍、Fastifyの6倍の速度
- **型安全性**: エンドツーエンドの型安全性
- **OpenAPI統合**: 自動的なAPIドキュメント生成
- **WebSocket対応**: リアルタイム通信のサポート
- **直感的なAPI**: シンプルで理解しやすいAPI設計

### 実装のポイント

- **適切なバリデーション**: 型安全なリクエスト/レスポンス処理
- **ミドルウェアの活用**: 認証、ログ、CORSなどの機能
- **エラーハンドリング**: 適切なエラー処理とレスポンス
- **テスト**: 型安全なテストの実装

### 実践的な用途

- **高速API開発**: 型安全性とパフォーマンスを重視したAPI
- **リアルタイムアプリケーション**: WebSocket対応のチャットや通知
- **マイクロサービス**: 軽量で高速なサービス間通信
- **プロトタイピング**: 迅速な開発とテスト

[ElysiaJS公式サイト](https://elysiajs.com/)を参考に、Bun最適化のTypeScriptフレームワークを活用した効率的なAPI開発を学びましょう。型安全性とパフォーマンスを両立した、現代的なWebアプリケーションの構築が可能です。
